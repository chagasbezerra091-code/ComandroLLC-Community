<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lithium Safety Monitor | Documenta√ß√£o COOSP</title>
    <style>
        /* Reutilizando estilos base do COOSP */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; margin: 0; padding: 0; background-color: #f4f4f9; color: #333; }
        .container { max-width: 1000px; margin: 40px auto; padding: 20px; background-color: #fff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); }
        header { background-color: #CC0000; color: white; padding: 15px 0; text-align: center; border-radius: 8px 8px 0 0; }
        header h1 { margin: 0; font-size: 2.2em; }
        .content h2 { color: #880000; border-bottom: 2px solid #ddd; padding-bottom: 5px; margin-top: 25px; }
        .content p { margin-bottom: 20px; }
        ul { list-style-type: disc; margin-left: 20px; }
        .critical-box { background-color: #ffdddd; border-left: 5px solid #cc0000; padding: 15px; margin: 15px 0; border-radius: 4px; font-weight: bold; }
        .code-snippet { background-color: #eee; padding: 10px; border-radius: 4px; overflow-x: auto; font-family: 'Consolas', 'Courier New', monospace; font-size: 0.9em; }
        footer { text-align: center; padding: 20px; margin-top: 30px; border-top: 1px solid #ddd; font-size: 0.9em; color: #666; }
    </style>
</head>
<body>

    <header>
        <h1>Lithium Safety Monitor (LSM)</h1>
        <p>M√≥dulo de Resposta a Falhas Catastr√≥ficas do Kernel-Core</p>
    </header>

    <div class="container">
        
        <div class="content">
            
            <h2>üõ°Ô∏è Vis√£o Geral do M√≥dulo</h2>
            
            <p>
                O **Lithium Safety Monitor (LSM)** √© um componente crucial, residente no `kernel-core`, projetado para garantir a seguran√ßa f√≠sica do usu√°rio. Diferente de m√≥dulos de gerenciamento de bateria comuns, o LSM opera em tempo real estrito para detectar falhas el√©tricas ou qu√≠micas que indiquem um evento t√©rmico descontrolado (Thermal Runaway) ou vazamento de l√≠tio.
            </p>
            <p>
                A prioridade do LSM √© **Zero Lat√™ncia de Resposta**, garantindo que, no momento da detec√ß√£o de uma falha cr√≠tica, o sistema reaja e desligue o hardware antes que a falha se propague.
            </p>

            <div class="critical-box">
                üö® **Aten√ß√£o:** Uma vez que o LSM confirma uma falha CR√çTICA (por exemplo, leitura acima de 5.0 PPM e curto-circuito), a a√ß√£o √© irrevers√≠vel: o sistema aciona o alerta de voz e inicia o desligamento imediato (*Hard Halt*).
            </div>

            <h2>üîç Mecanismos de Detec√ß√£o em Tempo Real</h2>
            
            <p>O LSM utiliza uma abordagem de dupla verifica√ß√£o que exige a confirma√ß√£o de dois eventos de hardware antes de declarar uma falha catastr√≥fica:</p>
            
            <ul>
                <li>
                    <strong>Detec√ß√£o Qu√≠mica/Qu√¢ntica (ADC/I2C):</strong> A fun√ß√£o <code>readLithiumSensorPPM()</code> acessa diretamente um sensor qu√≠mico dedicado, lendo o potencial de detec√ß√£o de √≠ons de l√≠tio ou o *stress* eletroqu√≠mico da c√©lula. Um valor acima de <code>CRITICAL_LITHIUM_PPM</code> (5.0 ppm) √© o primeiro gatilho.
                </li>
                <li>
                    <strong>Detec√ß√£o El√©trica (Registrador):</strong> A fun√ß√£o <code>isShortCircuitDetected()</code> l√™ um registrador de hardware de baixo n√≠vel (ex: endere√ßo <code>0xFF00FF00</code>) no PMIC (Power Management IC) ou SoC. A presen√ßa da <code>SC_REGISTER_FLAG</code> confirma que ocorreu um curto-circuito grave, o que √© consistente com a falha catastr√≥fica onde **"multiple motherboard circuits to fry"** (v√°rias placas da placa-m√£e fritaram).
                </li>
            </ul>

            <h2>üó£Ô∏è Rotina de Desligamento Catastr√≥fico (`triggerCatastrophicShutdown`)</h2>
            
            <p>Se as duas condi√ß√µes acima forem atendidas, o kernel desvia a execu√ß√£o para a rotina de seguran√ßa, que **n√£o pode ser interrompida**:</p>
            
            <ol>
                <li>
                    **Alerta Visual Imediato:** A FFI <code>comandro_ffi_display_fatal_message("LITHIUM DETECTED")</code> √© chamada, instruindo a interface a preencher o canto da tela com a mensagem de alerta em vermelho forte.
                </li>
                <li>
                    **Instru√ß√µes de Voz (Ingl√™s):** A FFI <code>comandro_ffi_voice_alert()</code> √© disparada para fornecer instru√ß√µes de seguran√ßa urgentes e claras em ingl√™s, incluindo a raz√£o da falha (dano √† placa-m√£e) e a ordem para **descartar imediatamente o dispositivo**.
                </li>
                <li>
                    **Auditoria e Log:** O erro √© gravado na NVRAM para auditoria de falha (*forensics*).
                </li>
                <li>
                    **Hard Halt:** A chamada <code>SystemHalt::powerOffImmediate()</code> desliga a energia do SoC e de todos os componentes de forma imediata e brutal (n√£o √© um desligamento gracioso), para mitigar a propaga√ß√£o do fogo ou dano t√©rmico.
                </li>
            </ol>
        </div>
    </div>

    <footer>
        <p>Este m√≥dulo garante a seguran√ßa do hardware acima da opera√ß√£o do sistema. Desenvolvido em C++ para Tempo Real.</p>
        <p><a href="o_que_e_coosp.html">Voltar para a Introdu√ß√£o do COOSP</a>.</p>
    </footer>

</body>
</html>
